_.isUndefined(window.vc)&&(window.vc={atts:{}}),(e=>{var t=Backbone.View.extend({events:{},$lg_offset_placeholder_value:!1,$lg_size_placeholder_value:!1,initialize:function(){_.bindAll(this,"setLgPlaceholders")},render:function(){return this},save:function(){var t=[];return this.$el.find(".vc_column_offset_field").each((function(){var a=e(this);a.is(":checkbox:checked")?t.push(a.attr("name")):a.is("select")&&""!==a.val()&&t.push(a.val())})),t},setLgPlaceholders:function(){var e=this.$lg_offset_placeholder_value.val().replace(/[^\d]/g,"");this.$lg_size.find("option:first").text(VcI8nColumnOffsetParam.inherit_default),this.$lg_offset.find("option:first").text(e?VcI8nColumnOffsetParam.inherit+e:"")}});vc.atts.column_offset={parse:function(e){return this.content().find("input.wpb_vc_param_value."+e.param_name).data("vcColumnOffset").save().join(" ")},init:function(a,i){e('[data-column-offset="true"]',i).each((function(){var a=e(this);a.find(".wpb_vc_param_value").data("vcColumnOffset",new t({el:a}).render())}))}}})(window.jQuery),_.isUndefined(window.vc)&&(window.vc={atts:{}}),(e=>{var t,a,i;t=wp.media,a=ajaxurl.replace(/admin\-ajax\.php/,"images/wpspin_light.gif"),t.controller.VcCssSingleImage=t.controller.VcSingleImage.extend({setCssEditor:function(e){return e&&(this._css_editor=e),this},updateSelection:function(){var e,t=this.get("selection"),a=this._css_editor.getBackgroundImage();void 0!==a&&""!==a&&-1!==a&&(e=_.map(a.toString().split(/,/),(function(e){return(e=wp.media.model.Attachment.get(e)).fetch(),e}))),t.reset(e)}}),i=vc.CssEditor=Backbone.View.extend({attrs:{},layouts:["margin","border-width","padding"],positions:["top","right","bottom","left"],$field:!1,simplify:!1,$simplify:!1,events:{"click .vc_icon-remove":"removeImage","click .vc_add-image":"addBackgroundImage","change .vc_simplify":"changeSimplify"},initialize:function(){_.bindAll(this,"setSimplify")},render:function(e){return this.attrs={},this.$simplify=this.$el.find(".vc_simplify"),this.setPlaceholders(),_.isString(e)&&this.parse(e),this},parse:function(e){(e=e.split(/\s*(\.[^\{]+)\s*\{\s*([^\}]+)\s*\}\s*/g))&&e[2]&&this.parseAtts(e[2].replace(/\s+!important/g,""))},addBackgroundImage:function(e){if(e&&e.preventDefault&&e.preventDefault(),window.vc_selectedFilters={},this.image_media)return this.image_media.open("vc_editor");this.image_media=t({state:"vc_single-image",states:[(new t.controller.VcCssSingleImage).setCssEditor(this)]}),this.image_media.on("toolbar:create:vc_single-image",(function(e){this.createSelectToolbar(e,{text:window.i18nLocale.set_image})}),this.image_media),this.image_media.state("vc_single-image").on("select",this.setBgImage),this.image_media.open("vc_editor")},setBgImage:function(){var t,a,i,n=this.get("selection"),s=(n=(t=n,a=this,i=[],e(".media-modal").addClass("processing-media"),t.each((function(e){i.push(e.get("id"))})),i),function(i){if(!window.vc||!window.vc.active_panel)return!1;i=_.map(i,(function(e){return e.attributes})),t.reset(i),i=_.map(t.models,(function(e){return e.attributes}));var n=vc.template(e("#vc_css-editor-image-block").html(),_.defaults({},{variable:"img"},vc.templateOptions.custom));a._css_editor.$el.find(".vc_background-image .vc_image").html(n(i[0])),e(".media-modal").removeClass("processing-media"),a._css_editor.$el.closest(".vc_edit-form-tab").trigger("change")});e.ajax({dataType:"json",type:"POST",url:window.ajaxurl,data:{action:"vc_media_editor_add_image",filters:window.vc_selectedFilters,ids:n,vc_inline:!0,_vcnonce:window.vcAdminNonce}}).done((function(t){var a,i,n,r;for(a=[],n=[],r=0;r<t.data.ids.length;r++)i=wp.media.model.Attachment.get(t.data.ids[r]),n.push(i.fetch()),a.push(i);e.when.apply(e,n).done((function(){s(a)}))})).fail((function(t){e(".media-modal-close").click(),window.vc&&window.vc.active_panel&&window.i18nLocale&&window.i18nLocale.error_while_saving_image_filtered&&vc.active_panel.showMessage(window.i18nLocale.error_while_saving_image_filtered,"error"),window.console&&window.console.warn&&window.console.warn("css_editor processImages error",t)})).always((function(){e(".media-modal").removeClass("processing-media")}))},setCurrentBgImage:function(t){var i,n,s=/([^\?]+)(\?id=\d+){0,1}/,r="";t.match(/^\d+$/)?(n=vc.template(e("#vc_css-editor-image-block").html(),_.defaults({},{variable:"img"},vc.templateOptions.custom)),this.$el.find(".vc_background-image .vc_image").html(n({url:a,id:t,css_class:"vc_preview"})),e.ajax({type:"POST",url:window.ajaxurl,data:{action:"wpb_single_image_src",content:t,size:"full",_vcnonce:window.vcAdminNonce},dataType:"html",context:this}).done((function(e){this.$el.find(".vc_ce-image").attr("src",e+"?id="+t).removeClass("vc_preview")}))):t.match(s)&&(i=(s=t.split(s))[1],s[2]&&(r=s[2].replace(/[^\d]+/,"")),n=vc.template(e("#vc_css-editor-image-block").html(),_.defaults({},{variable:"img"},vc.templateOptions.custom)),this.$el.find(".vc_background-image .vc_image").html(n({url:i,id:r})))},changeSimplify:function(){_.debounce(this.setSimplify,100)()},setSimplify:function(){this.simplifiedMode(this.$simplify[0].checked)},simplifiedMode:function(t){t?(this.simplify=!0,this.$el.addClass("vc_simplified")):(this.simplify=!1,this.$el.removeClass("vc_simplified"),_.each(this.layouts,(function(t){var a=e("[data-attribute="+(t="border-width"===t?"border":t)+"].vc_top");this.$el.find("[data-attribute="+t+"]:not(.vc_top)").val(a.val())}),this))},removeImage:function(t){var a=e(t.currentTarget);t&&t.preventDefault&&t.preventDefault(),a.parent().remove(),this.$el.closest(".vc_edit-form-tab").trigger("change")},getBackgroundImage:function(){return this.$el.find(".vc_ce-image").data("imageId")},setPlaceholders:function(){try{var e,t=this.$el.closest("#vc_ui-panel-edit-element").attr("data-vc-shortcode"),a=window.vc.map[t].params.find((function(e){return"css_editor"===e.type})).value;for(e in a){var i,n,s=e.replace(/\-+/g,"_"),r=this.$el.find("[name="+s+"]");r.length&&(i=r[0].tagName,r.attr("placeholder",a[e]),n=r.hasClass("vc_color-control"),"SELECT"===i||n)&&(r.val(a[e]),n)&&r.trigger("change")}}catch(e){console.error("Cannot set fields placeholders in css_editor.js.",e)}},parseAtts:function(e){var t=/(\d+\S*)\s+(\w+)\s+([\d\w#\(,]+)/,a=/^([^\s]+)\s+url\(([^\)]+)\)([\d\w]+\s+[\d\w]+)?$/,i=!1;_.map(e.split(";"),(function(e){var n,s=(e=e.split(/:\s/))[1]||"",r=e[0]||"";s=s&&s.trim();r.match(new RegExp("^("+this.layouts.join("|").replace("-","\\-")+")$"))&&s?(1===(n=s.split(/\s+/g)).length?n=[n[0],n[0],n[0],n[0]]:2===n.length?(n[2]=n[0],n[3]=n[1]):3===n.length&&(n[3]=n[1]),_.each(this.positions,(function(e,t){this.$el.find("[data-name="+r+"-"+e+"]").val(n[t])}),this)):"background-size"===r?(i=s,this.$el.find("[name=background_style]").val(s)):"background-repeat"!==r||i?"background-image"===r?this.setCurrentBgImage(s.replace(/url\(([^\)]+)\)/,"$1")):"background"===r&&s?((e=s.split(a))&&e[1]&&this.$el.find("[name="+r+"_color]").val(e[1]),e&&e[2]&&this.setCurrentBgImage(e[2])):"border"===r&&s&&s.match(t)?(e=s.split(t),n=[e[1],e[1],e[1],e[1]],_.each(this.positions,(function(e,t){this.$el.find("[name="+r+"_"+e+"_width]").val(n[t])}),this),this.$el.find("[name=border_style]").val(e[2]),this.$el.find("[name=border_color]").val(e[3]).trigger("change")):-1!=r.indexOf("border")&&s?-1!=r.indexOf("style")?this.$el.find("[name=border_style]").val(s):-1!=r.indexOf("color")?this.$el.find("[name=border_color]").val(s).trigger("change"):-1!=r.indexOf("radius")?this.$el.find("[name=border_radius]").val(s):r.match(/^[\w\-\d]+$/)&&this.$el.find("[name="+r.replace(/\-+/g,"_")+"]").val(s):r.match(/^[\w\-\d]+$/)&&s&&this.$el.find("[name="+r.replace(/\-+/g,"_")+"]").val(s):this.$el.find("[name=background_style]").val(s)}),this)},save:function(){var e="";return this.attrs={},_.each(this.layouts,(function(e){this.getFields(e)}),this),this.getBackground(),this.getBorder(),(e=_.isEmpty(this.attrs)?e:".vc_custom_"+Date.now()+"{"+_.reduce(this.attrs,(function(e,t,a){return t?e+a+": "+t+" !important;":e}),"",this)+"}")&&vc.frame_window&&vc.frame_window.vc_iframe.setCustomShortcodeCss(e),e},getBackgroundImageSrc:function(){return this.$el.find(".vc_background-image img").attr("src")},getBackgroundColor:function(){return this.$el.find("[name=background_color]").val()},getBackgroundStyle:function(){return this.$el.find("[name=background_style]").val()},getBackground:function(){var e=this.getBackgroundColor(),t=this.getBackgroundImageSrc(),a=this.getBackgroundStyle(),i=this.$el.find("[name=background_color]").attr("placeholder"),n=e;i&&e.toLowerCase()!==i.toLowerCase()&&(n=e),e&&t?this.attrs.background=e+" url("+t+")":n?this.attrs["background-color"]=n:t&&(this.attrs["background-image"]="url("+t+")"),a.match(/repeat/)?(this.attrs["background-position"]="0 0",this.attrs["background-repeat"]=a):a.match(/cover|contain/)&&(this.attrs["background-position"]="center",this.attrs["background-repeat"]="no-repeat",this.attrs["background-size"]=a),e.match(/^rgba/)&&(this.attrs["*background-color"]=e.replace(/\s+/,"").replace(/(rgb)a\((\d+)\,(\d+),(\d+),[^\)]+\)/,"$1($2,$3,$4)"))},getBorder:function(){var e=this.$el.find("[name=border_style]").val(),t=this.$el.find("[name=border_style]").attr("placeholder"),a=this.$el.find("[name=border_radius]").val(),i=this.$el.find("[name=border_radius]").attr("placeholder"),n=this.$el.find("[name=border_color]").val(),s=this.$el.find("[name=border_color]").attr("placeholder");this.attrs["border-width"]&&this.attrs["border-width"].match(/^\d+\S+$/)?(this.attrs.border=this.attrs["border-width"]+" "+(e||"initial")+" "+n,this.attrs["border-width"]=void 0,a&&i&&a!==i&&(this.attrs["border-radius"]=a)):(_.each(["left","right","top","bottom"],(function(a){this.attrs["border-"+a+"-width"]&&e&&(t&&e!==t||!t)&&(this.attrs["border-"+a+"-style"]=e)}),this),a&&(i&&a!==i||!i)&&(this.attrs["border-radius"]=a),n&&(s&&n.toLowerCase()!==s.toLowerCase()||!s)&&(this.attrs["border-color"]=n))},getFields:function(e){var t=[];if(this.simplify)return this.getSimplifiedField(e);_.each(this.positions,(function(a){var i=this.$el.find("[data-name="+e+"-"+a+"]").val();(i=(i=i.replace(/\s+/,"")).match(/^-?\d*(\.\d+){0,1}(%|in|cm|mm|em|rem|ex|pt|pc|px|vw|vh|vmin|vmax)$/)?i:isNaN(parseFloat(i))?"":parseFloat(i)+"px")&&i.length&&t.push({name:a,val:i})}),this),_.each(t,(function(t){var a="border-width"===e?"border-"+t.name+"-width":e+"-"+t.name;this.attrs[a]=t.val}),this)},getSimplifiedField:function(e){var t=this.$el.find("[data-name="+e+"-top]").val().replace(/\s+/,"");(t=t.match(/^-?\d*(\.\d+){0,1}(%|in|cm|mm|em|rem|ex|pt|pc|px|vw|vh|vmin|vmax)$/)?t:isNaN(parseFloat(t))?"":parseFloat(t)+"px").length&&(this.attrs[e]=t)}}),vc.atts.css_editor={parse:function(e){return this.content().find('input.wpb_vc_param_value[name="'+e.param_name+'"]').data("vcFieldManager").save()},init:function(t,a){e("[data-css-editor=true]",this.content()).each((function(){var a,n,s=e(this),r=s.find('input.wpb_vc_param_value[name="'+t.param_name+'"]'),o=r.val();o||(n={bg_color:"background-color",padding:"padding",margin_bottom:"margin-bottom",bg_image:"background-image"},a=vc.edit_element_block_view.model.get("params"),o=(n=_.reduce(n,(function(e,t,i){var n=a[i];return _.isUndefined(n)||!n.length?e:e+t+": "+(n="bg_image"===i?"url("+n+")":n)+";"}),""))?".tmp_class{"+n+"}":""),r.data("vcFieldManager",new i({el:s}).render(o))})),vc.atts.colorpicker.init.call(this,t,a)}}})(window.jQuery),_.isUndefined(window.vc)&&(window.vc={atts:{}}),(e=>{var t=Backbone.View.extend({events:{change:"setParams"},setParams:function(){var e,t=this.save(),a=(t=this.$el.find('[value="'+t+'"]'),vc.edit_element_block_view.content()),i=this.$el;t.length&&(t=t.data("params"),e=[],_.each(t,(function(t,i){var n;(i=a.find("[name="+i+"].wpb_vc_param_value")).length&&(i.unbind("change.vcParamsPreset"),(n=i.data("vcFieldManager"))&&n.render&&n.render(t),e.push(i),i.val(t).trigger("change"))})),_.each(e,(function(e){e.bind("change.vcParamsPreset",(function(e){_.isUndefined(e.extra_type)&&i.val("")}))})))},render:function(){return this.setParams(),this},save:function(){return this.$el.val()}});vc.atts.params_preset={parse:function(t){return e("select[name="+t.param_name+"]",this.content()).val()},init:function(a,i){e(".vc_params-preset-select",i).each((function(){var a=e(this);_.isUndefined(a.data("fieldManager"))&&a.data("fieldManager",new t({el:a}).render())}))}},e(".vc_ui-panel .additembutton").click((function(){var t=e(this).parent().parent().next().find(".listitemwindow");t.css({display:"block",top:"220px"}),t.find("[name='item_type']").val("items"),t.find("[name='item_value'], [name='item_content'], [name='item_url'], [name='item_content_color'], [name='item_value_color'], [name='item_value_background_color'], [name='item_border_color']").val(""),t.draggable({handle:e(".vc_panel-heading")}),t.resizable({handles:"n, e, s, w, ne, se, sw, nw"})})),e(".cancel-item-options, .listitemwindow .vc_close").click((function(t){t.preventDefault(),e(".listitemwindow").css("display","none")})),e("#add-item-shortcode").click((function(t){t.preventDefault();var a=window.tinyMCE.get("wpb_tinymce_content"),i=a.getContent(),n=e("[name='additemwindow'] [name='item_content_color']"),s=e("[name='additemwindow'] [name='item_value_color']"),r=e("[name='additemwindow'] [name='item_value_background_color']"),o=e("[name='additemwindow'] [name='item_border_color']"),c="[item"+(e("[name='additemwindow'] [name='item_type']").length?' type="'+e("[name='additemwindow'] [name='item_type']").val()+'"':"")+(e("[name='additemwindow'] [name='item_value']").length?' value="'+e("[name='additemwindow'] [name='item_value']").val()+'"':"")+(e("[name='additemwindow'] [name='item_url']").length?' url="'+e("[name='additemwindow'] [name='item_url']").val()+'"':"")+(e("[name='additemwindow'] [name='item_url_target']").length?' url_target="'+e("[name='additemwindow'] [name='item_url_target']").val()+'"':"")+(e("[name='additemwindow'] [name='item_icon']").length?' icon="'+e("[name='additemwindow'] [name='item_icon']").val()+'"':"")+(""!=n.length?' text_color="'+n.val()+'"':"")+(""!=s.length?' value_color="'+s.val()+'"':"")+(""!=r.length?' value_bg_color="'+r.val()+'"':"")+(""!=o.length?' border_color="'+o.val()+'"':"")+"]"+e("[name='additemwindow'] [name='item_content']").val()+"[/item]";a.setContent(e(i).text()+c),e(".listitemwindow").css("display","none")})),e(".gallery_widget_attached_images_ids").change((function(){var t=e(this).val().split(","),a=0;parseInt(t[0])&&(a=t.length);var i=e(this).hasClass("carousel_images")?5:e(this).hasClass("slider_images")?3:4,n=e(".wpb_el_type_attach_images").nextAll();n.slice(0,30*i+1).css("display","none"),a&&(n.slice(0,a*i).css("display","block"),n.slice(30*i,30*i+1).css("display","block"))})),setTimeout((function(){e(".gallery_widget_attached_images_ids").trigger("change")}),1),e(".vc_ui-panel [name^='testimonials_icon'], .vc_ui-panel [name^='testimonials_title'], .vc_ui-panel [name^='testimonials_author'], .vc_ui-panel [name^='testimonials_author_subtext']").parent().parent().css("display","none"),e(".vc_ui-panel [name='testimonials_count']").change((function(){var t=e(this),a=e(".vc_ui-panel [name$='29']").length;e(".vc_ui-panel [name^='testimonials_icon'], .vc_ui-panel [name^='testimonials_title'], .vc_ui-panel [name^='testimonials_author'], .vc_ui-panel [name^='testimonials_author_subtext']").parent().parent().css("display","none"),t.parent().parent().nextUntil("",":lt("+t.val()*a+")").css("display","block")})),setTimeout((function(){e("[name='testimonials_count']").trigger("change")}),1),e(".vc_ui-panel [name^='icon_type'], .vc_ui-panel [name^='icon_url'], .vc_ui-panel [name^='icon_target']").parent().parent().css("display","none"),e(".vc_ui-panel [name='icons_count']").change((function(){var t=e(this);e(".vc_ui-panel [name^='icon_type'], .vc_ui-panel [name^='icon_url'], .vc_ui-panel [name^='icon_target']").parent().parent().css("display","none"),t.parent().parent().nextUntil("",":lt("+3*t.val()+")").css("display","block")})),setTimeout((function(){e("[name='icons_count']").trigger("change")}),1)})(window.jQuery),(e=>{try{new window.vc.InitGalleries}catch(e){console.error("Could not initialize galleries: ",e)}var t=e("#vc_edit-form-tabs");t.length&&(e(".wpb-edit-form").addClass("vc_with-tabs"),t.find(".vc_edit-form-tab-control").removeClass("vc_active").eq(0).addClass("vc_active"),t.find('[data-vc-ui-element="panel-edit-element-tab"]').removeClass("vc_active").eq(0).addClass("vc_active"),t.find(".vc_edit-form-link").on("click",(function(a){var i=e(this);a.preventDefault(),t.find(".vc_active").removeClass("vc_active"),i.parent().addClass("vc_active"),e(i.attr("href")).addClass("vc_active").parents(".vc_panel-body").scrollTop(0)})))})(window.jQuery),_.isUndefined(window.vc)&&(window.vc={atts:{}}),(e=>{vc.atts.vc_grid_item={init:function(t){!0===vc_user_access().getState("grid_builder")||null===vc_user_access().getState("grid_builder")?this.content().find('[data-vc-shortcode-param-name="'+t.param_name+'"] [data-vc-grid-element="value"]').on("change",(function(){var a=e(this).val(),i=e(this).find("[value="+a+"]").data("vcLink");a&&e(this).parents('[data-vc-shortcode-param-name="'+t.param_name+'"]:first').find('[data-vc-grid-item="edit_link"]').attr("href",i)})).trigger("change"):this.content().find('[data-vc-shortcode-param-name="'+t.param_name+'"] .vc_description').remove()},parse:function(e){return(e=this.content().find('[data-vc-shortcode-param-name="'+e.param_name+'"] [data-vc-grid-element="value"]')).length?e.val():""}}})(window.jQuery);